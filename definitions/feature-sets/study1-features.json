{
  "url": "https://datatools4heart.eu/feature-sets/study1_features",
  "name": "study1_features",
  "title": "Time series data for study-1",
  "description": "Time series data for study-1",
  "version": "0.1",
  "date": "2023-01-26",
  "fhirVersion": "4.0.1",
  "publisher": "DT4H WP2 Team (SRDC Corp.)",
  "referenceTimePoints": {
    "method": "feature-group"
  },
  "featureGroup": [
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/encounters",
      "feature": [
        {
          "name": "encounterClass"
        },
        {
          "name": "admissionYear"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/patient_demographics",
      "feature": [
        {
          "name": "gender"
        },
        {
          "name": "age",
          "description": "Age of the patient at reference point",
          "valueExpr": {
            "fhirPath": "utl:getPeriod(birthDate, %referenceTimePoint, 'years')",
            "dataType": "integer"
          }
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/vital_signs",
      "pivot": {
        "name": "code",
        "description": "Vital signs collected in an encounter",
        "values": [
          {
            "name": "weight",
            "value": "29463-7"
          },
          {
            "name": "height",
            "value": "8302-2"
          },
          {
            "name": "systolicBp",
            "value": "8480-6"
          },
          {
            "name": "diastolicBp",
            "value": "8462-4"
          },
          {
            "name": "heartRate",
            "value": "8867-4"
          },
          {
            "name": "oxygenSaturation",
            "value": "2708-6"
          }
        ]
      },
      "join": {
        "type": "future"
      },
      "feature": [
        {
          "name": "value"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/vital_signs",
      "join": {
        "type": "future"
      },
      "feature": [
        {
          "name": "value"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/lab_results",
      "pivot": {
        "name": "code",
        "description": "Important lab results to be evaluated features",
        "values": [
          {
            "name": "hemoglobin",
            "value": "718-7"
          },
          {
            "name": "ferritin",
            "value": "2276-4"
          },
          {
            "name": "tfs",
            "value": "2502-3"
          },
          {
            "name": "ntProBnp",
            "value": "33762-6"
          },
          {
            "name": "bnp",
            "value": "30934-4"
          },
          {
            "name": "crpHs",
            "value": "1988-5"
          },
          {
            "name": "crpNonHs",
            "value": "30522-7"
          },
          {
            "name": "tropIHs",
            "value": "89579-7"
          },
          {
            "name": "tropInHs",
            "value": "10839-9"
          },
          {
            "name": "tropTHs",
            "value": "67151-1"
          },
          {
            "name": "tropTnHs",
            "value": "6598-7"
          },
          {
            "name": "triGly",
            "value": "14927-8"
          },
          {
            "name": "cholTot",
            "value": "14647-2"
          },
          {
            "name": "hdl",
            "value": "14646-4"
          },
          {
            "name": "ldl",
            "value": "22748-8"
          },
          {
            "name": "potassium",
            "value": "2823-3"
          },
          {
            "name": "sodium",
            "value": "2951-2"
          },
          {
            "name": "creatBS",
            "value": "2160-0"
          },
          {
            "name": "creatUS",
            "value": "2161-8"
          },
          {
            "name": "albuminBS",
            "value": "1751-7"
          },
          {
            "name": "albuminUS",
            "value": "1754-1"
          },
          {
            "name": "eGFR",
            "value": "69405-9"
          },
          {
            "name": "bun",
            "value": "14937-7"
          },
          {
            "name": "acr",
            "value": "32294-1"
          },
          {
            "name": "hba1c%",
            "value": "4548-4"
          },
          {
            "name": "hba1c",
            "value": "41995-2"
          }
        ]
      },
      "join": {
        "type": "future",
        "duration": "1d"
      },
      "feature": [
        {
          "name": "value"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/conditions",
      "feature": [
        {
          "name": "icd10Code"
        },
        {
          "name": "conditionName"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/conditions",
      "filter": {
        "name": "heartFailure",
        "fhirPath": "icd10Code.startsWith('I50') or icd10Code.startsWith('I11') or icd10Code.startsWith('I13.0') or icd10Code.startsWith('I13.2') or icd10Code.startsWith('I26.0') or icd10Code.startsWith('I09.81') or icd10Code.startsWith('I97.13')"
      },
      "feature": [
        {
          "name": "earliest",
          "valueExpr": {
            "fhirPath": "icd10Code",
            "dataType": "code"
          },
          "temporalAgg": [
            {
              "aggOp": ["first"]
            }
          ]
        },
        {
          "name": "timeFromEarliest",
          "valueExpr": {
            "fhirPath": "utl:getPeriod(onsetDate, %referenceTimePoint,'mo').toInteger()",
            "dataType": "integer"
          },
          "temporalAgg": [
            {
              "aggOp": ["first"]
            }
          ]
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/symptoms",
      "pivot": {
        "name": "code",
        "description": "Important lab results to be evaluated features",
        "values": [
          {
            "name": "dyspnea",
            "value": "267036007"
          },
          {
            "name": "pleuralEffusion",
            "value": "60046008"
          },
          {
            "name": "edema",
            "value": "267038008"
          },
          {
            "name": "fatigue",
            "value": "84229001"
          }
        ]
      },
      "join": {
        "type": "future",
        "duration": "1d"
      },
      "feature": [
        {
          "name": "display",
          "valueExpr": {
            "fhirPath": "code.exists()",
            "dataType": "boolean"
          },
          "temporalAgg": [
            {
              "aggOp": ["any"]
            }
          ]
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/echocardiographs",
      "feature": [
        {
          "name": "lvef"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/electrocardiographs",
      "feature": [
        {
          "name": "ecg_qrs_duration"
        },
        {
          "name": "ecg_qrs_axis"
        },
        {
          "name": "ecg_qt_duration_corrected"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/smoking_status",
      "join": {
        "type": "past",
        "duration": "1a"
      },
      "feature": [
        {
          "name": "startTime"
        },
        {
          "name": "endTime"
        },
        {
          "name": "dose"
        },
        {
          "name": "formerSmoker",
          "description": "Whether the patient smoked within 1 year prior to the admission",
          "valueExpr": {
            "fhirPath": "endTime.exists()",
            "dataType": "boolean"
          },
          "temporalAgg": [
            {
              "aggOp": [
                "any"
              ]
            }
          ]
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/smoking_status",
      "feature": [
        {
          "name": "smoker",
          "description": "Whether the patient is smoking currently. We check the last smoking status record and expect that it does not have an end date indicating that the patient is a current smoker",
          "valueExpr": {
            "fhirPath": "startTime.exists() and endTime.exists().not()",
            "dataType": "boolean"
          },
          "temporalAgg": [
            {
              "aggOp": [
                "last"
              ]
            }
          ]
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/nyha",
      "feature": [
        {
          "name": "value"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/hyperkalemia_severity",
      "feature": [
        {
          "name": "categorizedValue"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/ckd_severity",
      "feature": [
        {
          "name": "categorizedValue"
        }
      ]
    },

    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "rasi",
        "fhirPath": "medicationCode.startsWith('C09AA') or medicationCode.startsWith('C09B') or medicationCode.startsWith('C09CA') or medicationCode.startsWith('C09D') or medicationCode.startsWith('C09X')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "arni",
        "fhirPath": "medicationCode.startsWith('C09DX04')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "acei",
        "fhirPath": "medicationCode.startsWith('C09AA') or medicationCode.startsWith('C09BA') or medicationCode.startsWith('C09BB0') or medicationCode.startsWith('C09BB10') or medicationCode.startsWith('C09BB11') or medicationCode.startsWith('C09BB12') or medicationCode.startsWith('C09BX')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "arb",
        "fhirPath": "medicationCode.startsWith('C09CA') or medicationCode.startsWith('C09DA') or medicationCode.startsWith('C09DB') or medicationCode.startsWith('C09DX01') or medicationCode.startsWith('C09DX02') or medicationCode.startsWith('C09DX03') or medicationCode.startsWith('C09DX05') or medicationCode.startsWith('C09DX06') or medicationCode.startsWith('C09DX07')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "mra",
        "fhirPath": "medicationCode.startsWith('C03DA') or medicationCode.startsWith('C03EA') or medicationCode.startsWith('C03EB')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "diuretics",
        "fhirPath": "medicationCode.startsWith('C03A') or medicationCode.startsWith('C03D') or medicationCode.startsWith('C03E') or medicationCode.startsWith('C03XA') or (medicationCode.startsWith('C03BA') and medicationCode.startsWith('C03BA82').not()) or medicationCode.startsWith('C03BB') or medicationCode.startsWith('C03CA') or medicationCode.startsWith('C03CB') or medicationCode.startsWith('C03EB') or medicationCode.startsWith('C03XA') or medicationCode.startsWith('C03CC') or medicationCode.startsWith('C03CX')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "anti_coag",
        "fhirPath": "medicationCode.startsWith('BO1AA') or medicationCode.startsWith('BO1AB') or medicationCode.startsWith('BO1AX04') or medicationCode.startsWith('BO1AX05') or medicationCode.startsWith('BO1AF') or medicationCode.startsWith('BO1AE') or medicationCode.startsWith('BO1AX01') or medicationCode.startsWith('BO1AD12') pr medicationCode.startsWith('BO1AB02')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "anti_plat",
        "fhirPath": "medicationCode.startsWith('BO1AC13') or medicationCode.startsWith('BO1AC17') or medicationCode.startsWith('BO1AC16') or medicationCode.startsWith('BO1AC04') or medicationCode.startsWith('BO1AC22') or medicationCode.startsWith('BO1AC05') or medicationCode.startsWith('BO1AC25') or medicationCode.startsWith('BO1AC24') or medicationCode.startsWith('BO1AC19') or medicationCode.startsWith('BO1AC11') or medicationCode.startsWith('BO1AC21') or medicationCode.startsWith('BO1AC06') or medicationCode.startsWith('BO1AC15') or medicationCode.startsWith('BO1AC08') or medicationCode.startsWith('BO1AC10') or medicationCode.startsWith('BO1AC18') or medicationCode.startsWith('BO1AC07') or medicationCode.startsWith('BO1AC03') or medicationCode.startsWith('BO1AC23') or medicationCode.startsWith('BO1AC07') or medicationCode.startsWith('BO1AC18') or medicationCode.startsWith('BO1AC01') or medicationCode.startsWith('BO1AC02') or medicationCode.startsWith('BO1AC26')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "thrombolytic",
        "fhirPath": "medicationCode.startsWith('BO1AD02') or medicationCode.startsWith('BO1AD07') or medicationCode.startsWith('BO1AD11') or medicationCode.startsWith('BO1AD08') or medicationCode.startsWith('BO1AD04') or medicationCode.startsWith('BO1AD03') or medicationCode.startsWith('BO1AD01') or medicationCode.startsWith('BO1AD09') or medicationCode.startsWith('BO1AD06') or medicationCode.startsWith('BO1AD05')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "bb",
        "fhirPath": "medicationCode.startsWith('C07AA') or medicationCode.startsWith('C07AB') or medicationCode.startsWith('C07AG') or medicationCode.startsWith('C07BA') or medicationCode.startsWith('C07BB') or medicationCode.startsWith('C07BG') or medicationCode.startsWith('C07CA') or medicationCode.startsWith('C07CB') or medicationCode.startsWith('CG') or medicationCode.startsWith('C07DA') or medicationCode.startsWith('C07DB') or medicationCode.startsWith('C07DG') or medicationCode.startsWith('C07FB') or medicationCode.startsWith('C07FX')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "calciumcb",
        "fhirPath": "medicationCode.startsWith('C08C') or medicationCode.startsWith('C08D') or medicationCode.startsWith('C08E') or medicationCode.startsWith('C08GA')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "digitalis",
        "fhirPath": "medicationCode.startsWith('C01AA01') or medicationCode.startsWith('C01AA02') or medicationCode.startsWith('C01AA03') or medicationCode.startsWith('C01AA04') or medicationCode.startsWith('C01AA05') or medicationCode.startsWith('C01AA06') or medicationCode.startsWith('C01AA07') or medicationCode.startsWith('C01AA08')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "antiarr",
        "fhirPath": "medicationCode.startsWith('C01BA') or medicationCode.startsWith('C01BB') or medicationCode.startsWith('C01BC') or medicationCode.startsWith('C01BD') or medicationCode.startsWith('C01BG')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "inotropes",
        "fhirPath": "medicationCode.startsWith('C01CA') or medicationCode.startsWith('C01CE') or medicationCode.startsWith('C01CX')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "vasodil",
        "fhirPath": "medicationCode.startsWith('C01DA') or medicationCode.startsWith('C01DB') or medicationCode.startsWith('C01DX')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "lipid_lowering",
        "fhirPath": "medicationCode.startsWith('C10AA') or medicationCode.startsWith('C10BA') or medicationCode.startsWith('C10BX') or medicationCode.startsWith('C10AX13') or medicationCode.startsWith('C10AX14') or medicationCode.startsWith('C10AX16') or medicationCode.startsWith('C10AX09')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "ivabradine",
        "fhirPath": "medicationCode.startsWith('C01EB17')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "pot_bin",
        "fhirPath": "medicationCode.startsWith('V03AE01') or medicationCode.startsWith('V03AE10') or medicationCode.startsWith('V03AE09')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "insulins",
        "fhirPath": "medicationCode.startsWith('A10AB') or medicationCode.startsWith('A10AC') or medicationCode.startsWith('A10AD') or medicationCode.startsWith('A10AE') or medicationCode.startsWith('A10AF')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "oral_antidiabetic",
        "fhirPath": "medicationCode.startsWith('A10BA') or medicationCode.startsWith('A10BB') or medicationCode.startsWith('A10BG') or medicationCode.startsWith('A10BF') or medicationCode.startsWith('A10BH') or medicationCode.startsWith('A10BJ') or medicationCode.startsWith('A10BX09') or medicationCode.startsWith('A10BK01') or medicationCode.startsWith('A10BX12') or medicationCode.startsWith('A10BK03')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "hypog",
        "fhirPath": "medicationCode.startsWith('V03AH01')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "ari",
        "fhirPath": "medicationCode.startsWith('A10XA')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "resp_opd_inhal",
        "fhirPath": "medicationCode.startsWith('R03AA') or medicationCode.startsWith('R03AB') or medicationCode.startsWith('R03AC') or medicationCode.startsWith('R03AH') or medicationCode.startsWith('R03AK') or medicationCode.startsWith('R03AL') or medicationCode.startsWith('R03BA') or medicationCode.startsWith('R03BB') or medicationCode.startsWith('R03BC') or medicationCode.startsWith('R03BX')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "resp_opd_syst",
        "fhirPath": "medicationCode.startsWith('R03CA') or medicationCode.startsWith('R03CB') or medicationCode.startsWith('R03CC') or medicationCode.startsWith('R03CK') or medicationCode.startsWith('R03DA') or medicationCode.startsWith('R03DB') or medicationCode.startsWith('R03DC') or medicationCode.startsWith('R03DX')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "cortico_syst",
        "fhirPath": "medicationCode.startsWith('H02A') or medicationCode.startsWith('H02BX') or medicationCode.startsWith('H02C')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/medications",
      "filter": {
        "name": "aid",
        "fhirPath": "medicationCode.startsWith('M01AB') or medicationCode.startsWith('M01AX') or medicationCode.startsWith('C01EB16')"
      },
      "feature": [
        {
          "name": "taken",
          "valueExpr": {
            "fhirPath": "medicationCode.exists()",
            "dataType": "boolean"
          }
        },
        {
          "name": "startTime"
        },
        {
          "name": "medicationCode"
        },
        {
          "name": "dose"
        }
      ]
    },

    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/conditions",
      "filter": {
        "name": "cardiomyopathy",
        "fhirPath": "icd10Code.startsWith('I42') or icd10Code.startsWith('I43')"
      },
      "feature": [
        {
          "name": "occurred",
          "valueExpr": {
            "fhirPath": "icd10Code.exists()",
            "dataType": "boolean"
          }
        }
      ]
    },
    {
      "reference": "https://datatools4heart.eu/feature-groups/study1/conditions",
      "filter": {
        "name": "cardiomyopathy",
        "fhirPath": "icd10Code.startsWith('I42') or icd10Code.startsWith('I43')"
      },
      "join": {
        "type": "future"
      },
      "feature": [
        {
          "name": "occurred",
          "valueExpr": {
            "fhirPath": "icd10Code.exists()",
            "dataType": "boolean"
          },
          "temporalAgg": [
            {
              "windowPeriod": "d",
              "windowSize": 7,
              "aggOp": ["any"]
            },{
              "windowPeriod": "mo",
              "windowSize": 1,
              "aggOp": ["any"]
            },{
              "windowPeriod": "mo",
              "windowSize": 3,
              "aggOp": ["any"]
            },{
              "windowPeriod": "mo",
              "windowSize": 6,
              "aggOp": ["any"]
            },{
              "windowPeriod": "a",
              "windowSize": 1,
              "aggOp": ["any"]
            },{
              "windowPeriod": "a",
              "windowSize": 3,
              "aggOp": ["any"]
            },{
              "windowPeriod": "a",
              "windowSize": 5,
              "aggOp": ["any"]
            }
          ]
        },
        {
          "name": "date",
          "valueExpr": {
            "fhirPath": "iif(onsetDate.exists(), onsetDate.toDate(), {})",
            "dataType": "date"
          },
          "temporalAgg": [
            {
              "windowPeriod": "d",
              "windowSize": 7,
              "aggOp": ["first"]
            },{
              "windowPeriod": "mo",
              "windowSize": 1,
              "aggOp": ["first"]
            },{
              "windowPeriod": "mo",
              "windowSize": 3,
              "aggOp": ["first"]
            },{
              "windowPeriod": "mo",
              "windowSize": 6,
              "aggOp": ["first"]
            },{
              "windowPeriod": "a",
              "windowSize": 1,
              "aggOp": ["first"]
            },{
              "windowPeriod": "a",
              "windowSize": 3,
              "aggOp": ["first"]
            },{
              "windowPeriod": "a",
              "windowSize": 5,
              "aggOp": ["first"]
            }
          ]
        },
        {
          "name": "timeFromDischarge",
          "valueExpr": {
            "fhirPath": "iif(onsetDate.exists(), utl:getPeriod(%referenceTimePoint, onsetDate, 'mo').toInteger(), -1)",
            "dataType": "integer"
          }
        }
      ]
    }
  ],
  "combinedFeature": [
    {
      "name": "meanBp",
      "description": "Mean blood pressure",
      "combinedFeatures": [
        {
          "alias": "diastolicBp",
          "featureNamePattern": "vital_signs_diastolicBp_value_f"
        },
        {
          "alias": "systolicBp",
          "featureNamePattern": "vital_signs_systolicBp_value_f"
        }
      ],
      "valueExpr": {
        "fhirPath": "diastolicBp + (systolicBp - diastolicBp) / 3",
        "dataType": "decimal"
      }
    },
    {
      "name": "bmi",
      "description": "Body mass index",
      "combinedFeatures": [
        {
          "alias": "weight",
          "featureNamePattern": "vital_signs_weight_value_f"
        },
        {
          "alias": "height",
          "featureNamePattern": "vital_signs_height_value_f"
        }
      ],
      "valueExpr": {
        "fhirPath": "iif(height != 0, weight / (height * height / 10000), {})",
        "dataType": "decimal"
      }
    }
  ]
}
