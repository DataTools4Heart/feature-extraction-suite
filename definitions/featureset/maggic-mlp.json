{
  "url": "https://datatools4heart.eu/feature-sets/maggic-mlp",
  "name": "maggic-mlp",
  "title": "MAGGIC-MLP Features",
  "description": "Set of extracted features for MAGGIC-MLP",
  "version": "0.1",
  "status": "draft",
  "date": "2025-01-09",
  "publisher": "DT4H WP2 Team (SRDC Corp.)",
  "entity": [
    {
      "name": "pid",
      "description": "A unique identifier assigned to each patient in the cohort."
    },
    {
      "name": "encounterId",
      "description": "A unique identifier for each hospital encounter."
    }
  ],
  "sampling": {
    "description": "Use the end time of encounters as the reference time point.",
    "events": [
      {
        "url": "https://datatools4heart.eu/feature-groups/study1/encounters",
        "join": {
          "on": {
            "pid": "pid",
            "encounterId": "encounterId"
          }
        },
        "useEndTime": true
      }
    ]
  },
  "feature": [
    {
      "url": "https://datatools4heart.eu/feature-groups/study1/patient_demographics",
      "join": {
        "on": {
          "pid": "pid"
        }
      },
      "feature": [
        {
          "name": "gender",
          "description": "Gender of the patient"
        },
        {
          "name": "age",
          "description": "Age of the patient at reference point",
          "value": {
            "path": "utl:getPeriod(birthDate, %referenceTimePoint, 'years')",
            "dataType": "integer"
          }
        }
      ]
    },
    {
      "url": "https://datatools4heart.eu/feature-groups/study1/nyha",
      "join": {
        "on": {
          "pid": "pid",
          "encounterId": "encounterId"
        }
      },
      "feature": [
        {
          "name": "nyha",
          "description": "The latest value of the New York Heart Assessment as LOINC Code"
        }
      ]
    },
    {
      "url": "https://datatools4heart.eu/feature-groups/study1/vital_signs",
      "join": {
        "on": {
          "pid": "pid",
          "encounterId": "encounterId"
        }
      },
      "pivot": {
        "name": "code",
        "description": "Important vital signs",
        "values": [
          {
            "name": "systolic-blood-pressure",
            "value": "8480-6"
          },
          {
            "name": "bmi",
            "value": "39156-5"
          }
        ]
      },
      "feature": [
        {
          "name": "value",
          "description": "The latest numeric result"
        }
      ]
    },
    {
      "url": "https://datatools4heart.eu/feature-groups/study1/lab_results",
      "join": {
        "on": {
          "pid": "pid",
          "encounterId": "encounterId"
        }
      },
      "pivot": {
        "name": "code",
        "description": "Important lab results",
        "values": [
          {
            "name": "sodium",
            "value": "2951-2"
          },
          {
            "name": "creatinine",
            "value": "2160-0"
          },
          {
            "name": "urinary_creatinine",
            "value": "2161-8"
          }
        ]
      },
      "feature": [
        {
          "name": "value",
          "description": "The latest numeric result"
        }
      ]
    },
    {
      "url": "https://datatools4heart.eu/feature-groups/study1/conditions",
      "join": {
        "on": {
          "pid": "pid"
        }
      },
      "filter": {
        "name": "heart-failure",
        "description": "Find the Heart Failures.",
        "filter": "icd10Code.startsWith('I50') or icd10Code.startsWith('I11.0') or icd10Code.startsWith('I13.0') or icd10Code.startsWith('I13.2') or icd10Code.startsWith('I26.0') or icd10Code.startsWith('I25.5') or icd10Code.startsWith('I09.81') or icd10Code.startsWith('I97.13')"
      },
      "feature": [
        {
          "name": "occurred_prior_to_18_months",
          "description": "Indicates whether the condition was diagnosed 18 months or more before the reference time point, corresponding to the criteria for 'Heart Failure (HF) â‰¥ 18 Months Prior.'",
          "value": {
            "path": "icd10Code.exists() and utl:getPeriod(date, %referenceTimePoint, 'months') >= 18",
            "dataType": "boolean"
          },
          "temporalAgg": [
            {
              "aggOp": [
                "any"
              ]
            }
          ]
        }
      ]
    },
    {
      "url": "https://datatools4heart.eu/feature-groups/study1/conditions",
      "join": {
        "on": {
          "pid": "pid",
          "encounterId": "encounterId"
        }
      },
      "feature": [
        {
          "name": "has_chronic_obstructive_pulmonary_disease",
          "description": "Whether the patient has the Chronic Obstructive Pulmonary Disease (COPD).",
          "value": {
            "path": "icd10Code.startsWith('J40') or icd10Code.startsWith('J41') or icd10Code.startsWith('J42') or icd10Code.startsWith('J43') or icd10Code.startsWith('J44')",
            "dataType": "boolean"
          },
          "temporalAgg": [
            {
              "aggOp": [
                "any"
              ]
            }
          ]
        },
        {
          "name": "has_atrial_fibrillation",
          "description": "Whether the patient has the Atrial Fibrillations.",
          "value": {
            "path": "icd10Code.startsWith('I48')",
            "dataType": "boolean"
          },
          "temporalAgg": [
            {
              "aggOp": [
                "any"
              ]
            }
          ]
        },
        {
          "name": "has_myocardial_infarction",
          "description": "Whether the patient has the Myocardial Infarctions.",
          "value": {
            "path": "icd10Code.startsWith('I21') or icd10Code.startsWith('I22')",
            "dataType": "boolean"
          },
          "temporalAgg": [
            {
              "aggOp": [
                "any"
              ]
            }
          ]
        },
        {
          "name": "has_pci",
          "description": "Whether the patient has the Percutaneous Coronary Intervention (PCI).",
          "value": {
            "path": "icd10Code.startsWith('K49') or icd10Code.startsWith('K50') or icd10Code.startsWith('K75')",
            "dataType": "boolean"
          },
          "temporalAgg": [
            {
              "aggOp": [
                "any"
              ]
            }
          ]
        },
        {
          "name": "has_cabg",
          "description": "Whether the patient has the Coronary Artery Bypass Graft (CABG) Surgeries.",
          "value": {
            "path": "icd10Code.startsWith('K40') or icd10Code.startsWith('K41') or icd10Code.startsWith('K42') or icd10Code.startsWith('K43') or icd10Code.startsWith('K44') or icd10Code.startsWith('K45') or icd10Code.startsWith('K46') or icd10Code.startsWith('K47')",
            "dataType": "boolean"
          },
          "temporalAgg": [
            {
              "aggOp": [
                "any"
              ]
            }
          ]
        },
        {
          "name": "has_stroke",
          "description": "Whether the patient has the strokes.",
          "value": {
            "path": "icd10Code.startsWith('I61') or icd10Code.startsWith('I62') or icd10Code.startsWith('I63') or icd10Code.startsWith('I64') or icd10Code.startsWith('I60')",
            "dataType": "boolean"
          },
          "temporalAgg": [
            {
              "aggOp": [
                "any"
              ]
            }
          ]
        },
        {
          "name": "has_diabetes",
          "description": "Whether the patient has the diabetes.",
          "value": {
            "path": "icd10Code.startsWith('E10') or icd10Code.startsWith('E11') or icd10Code.startsWith('E12') or icd10Code.startsWith('E13') or icd10Code.startsWith('E14')",
            "dataType": "boolean"
          },
          "temporalAgg": [
            {
              "aggOp": [
                "any"
              ]
            }
          ]
        }
      ]
    },
    {
      "url": "https://datatools4heart.eu/feature-groups/study1/medications",
      "join": {
        "on": {
          "pid": "pid",
          "encounterId": "encounterId"
        }
      },
      "filter": {
        "name": "beta-blocker-use",
        "description": "Find Beta Blocker medications.",
        "filter": "medicationCode.startsWith('C07AA') or medicationCode.startsWith('C07AB') or medicationCode.startsWith('C07AG') or medicationCode.startsWith('C07BA') or medicationCode.startsWith('C07BB') or medicationCode.startsWith('C07BG') or medicationCode.startsWith('C07CA') or medicationCode.startsWith('C07CB') or medicationCode.startsWith('C07CG') or medicationCode.startsWith('C07DA') or medicationCode.startsWith('C07DB') or medicationCode.startsWith('C07DG') or medicationCode.startsWith('C07FB') or medicationCode.startsWith('C07FX')"
      },
      "feature": [
        {
          "name": "administered",
          "description": "Whether the medication administered.",
          "value": {
            "path": "medicationCode.exists()",
            "dataType": "boolean"
          }
        }
      ]
    },
    {
      "url": "https://datatools4heart.eu/feature-groups/study1/medications",
      "join": {
        "on": {
          "pid": "pid",
          "encounterId": "encounterId"
        }
      },
      "filter": {
        "name": "ace-inhibitors-arb-use",
        "description": "Find ACE Inhibitors / ARB Use medications.",
        "filter": "medicationCode.startsWith('C09AA') or medicationCode.startsWith('C09BA') or medicationCode.startsWith('C09BB02') or medicationCode.startsWith('C09BB03') or medicationCode.startsWith('C09BB04') or medicationCode.startsWith('C09BB05') or medicationCode.startsWith('C09BB06') or medicationCode.startsWith('C09BB07') or medicationCode.startsWith('C09BB08') or medicationCode.startsWith('C09BB09') or medicationCode.startsWith('C09BB010') or medicationCode.startsWith('C09BB011') or medicationCode.startsWith('C09BB012') or medicationCode.startsWith('C09BX01') or medicationCode.startsWith('C09BX02') or medicationCode.startsWith('C09BX03') or medicationCode.startsWith('C09BX04') or medicationCode.startsWith('C09BX05') or medicationCode.startsWith('C09CA') or medicationCode.startsWith('C09DA') or medicationCode.startsWith('C09DB') or medicationCode.startsWith('C09DX01') or medicationCode.startsWith('C09DX02') or medicationCode.startsWith('C09DX03') or medicationCode.startsWith('C09DX04') or medicationCode.startsWith('C09DX05') or medicationCode.startsWith('C09DX06') or medicationCode.startsWith('C09DX07') or medicationCode.startsWith('C09DX04')"
      },
      "feature": [
        {
          "name": "administered",
          "description": "Whether the medication administered.",
          "value": {
            "path": "medicationCode.exists()",
            "dataType": "boolean"
          }
        }
      ]
    },
    {
      "url": "https://datatools4heart.eu/feature-groups/study1/echocardiographs",
      "join": {
        "on": {
          "pid": "pid",
          "encounterId": "encounterId"
        }
      },
      "feature": [
        {
          "name": "lvef",
          "description": "The most recent left ventricular ejection fraction (LVEF) recorded prior to the reference time point.",
          "value": {
            "path": "lvef",
            "dataType": "decimal"
          }
        }
      ]
    },
    {
      "url": "https://datatools4heart.eu/feature-groups/study1/smoking_status",
      "join": {
        "on": {
          "pid": "pid"
        }
      },
      "feature": [
        {
          "name": "smoker",
          "description": "Indicates whether the patient's most recent recorded smoking status, collected before the reference time point, classifies them as a current smoker. A value of 1 denotes a current smoker, while 0 represents either a former smoker or someone who has never smoked.",
          "value": {
            "path": "iif(code = '449868002' or code = '428041000124106' or code = '77176002' or code = '230063004' or code = '230060001',1,iif(code = '8517006' or code = '266919005',0,{}))",
            "dataType": "integer"
          }
        }
      ]
    }
  ],
  "outcome": [
    {
      "url": "https://datatools4heart.eu/feature-groups/study1/patient_demographics",
      "join": {
        "on": {
          "pid": "pid"
        }
      },
      "feature": [
        {
          "name": "deceased",
          "description": "Mortality recorded within the 12 months following the reference time point, which corresponds to the end of the encounter.",
          "value": {
            "path": "deceasedDateTime.exists() and utl:getPeriod(%referenceTimePoint, deceasedDateTime, 'months') <= 12",
            "dataType": "boolean"
          }
        }
      ]
    }
  ]
}